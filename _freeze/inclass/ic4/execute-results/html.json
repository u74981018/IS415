{
  "hash": "ec4bacf5feeeafcb41dc190cca57b6c6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"In-class 4\"\nauthor: \"Lucas Vial\"\ndate: \"Sep 9 2024\"\ndate-modified: \"Date\"\nexecute: \n  eval: false\n  echo: true\n  freeze: true\n  warning: false\n---\n\n\n## Forest Fires in Sumatra, Indonesia \n\n### STKDE - Spatio-Temporal KDE (Kernel Density Estimator) \n\nKDE but you have one for distance in space and one in time\n\n### Imports and Data Wrangling \n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sf, tmap, tidyverse, raster, spatstat, sparr, dplyr)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nkbb_sf <- st_read(dsn = \"data/4data/rawdata\", \n  layer = \"Kepulauan_Bangka_Belitung\") %>%\n  st_union() %>%\n  st_zm(drop = TRUE, what = \"ZM\") %>%\n  st_transform(crs = 32748) #This number is a EPSG \n```\n:::\n\n\nEPSG - A number to refer to an area on the (world) map\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkbb_owin <- as.owin(kbb_sf)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(kbb_owin)\n```\n:::\n\n\nMake the csv (long, lat) into workable data :)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfire_sf <- read_csv(\"data/4data/rawdata/forestfires.csv\") %>%\n  st_as_sf(coords = c(\"longitude\", \"latitude\"),\n           crs = 4326) %>% \n  st_transform(crs = 32748)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfire_sf <- fire_sf %>% \n  mutate(DayofYear = yday(acq_date)) %>%\n  mutate(Month_num = month(acq_date)) %>%\n  mutate(Month_fac = month(acq_date,\n                           label = TRUE,\n                           abbr = FALSE)) # January or JAN ??\n```\n:::\n\n\n\\^\\^ this code makes acq data numeric - makes them into new columns\n\n### Plotting\n\n**lubridate** is the timedate package used in this course (more talk about tidyverse ðŸ˜»)\n\nBe aware of Interactive mode being on or off\n\nThe Below code is very literal - Its drawing the polygon of kbb_sf and then adding the dots over the top\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(kbb_sf)+\n  tm_polygons() +\ntm_shape(fire_sf)+\n  tm_dots()\n```\n:::\n\n\nEach Month Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(kbb_sf)+\n  tm_polygons() +\ntm_shape(fire_sf)+\n  tm_dots(size = 0.1)+\ntm_facets(by=\"Month_fac\",\n          free.coords = FALSE, #will be weird and zoomed in\n          drop.units = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Doesn't Work - \nfire_month <- fire_sf %>%\n  dplyr::select(Month_num)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfire_month_ppp <- as.ppp(fire_month)\nfire_month_ppp\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfire_month_owin <- fire_month_ppp[kbb_owin]\n```\n:::\n\n\n### Computing and Plotting SPKDE\n\n\n::: {.cell}\n\n```{.r .cell-code}\nst_kde <- spattemp.density(fire_month_owin)\nsummary(st_kde)\n```\n:::\n\n\nh = Spatial, which is 15102 = 15 km\n\nlambda = Temporal, which is 0.0304 = 0.03 months\n\nNotice how fig height and width makes the graphs looks half decent\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntims <- c(7,8,9,10,11,12)\npar(mfcol=c(2,3))\nfor(i in tims){\n  plot(st_kde, i,\n       override.par=FALSE,\n       fix.range=TRUE,\n       main=paste(\"KDE at month\",i))\n}\n```\n:::\n\n\nTheres a way to make it into a gif where you can do it day by day\n\n(he teased the code but didnt tell us how to do it ðŸ˜ )\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}